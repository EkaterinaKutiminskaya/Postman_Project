# Postman_Project
Изначально, данный проект задумывался как использование инструмента Interceptor.
Но пошаговая модернизация проекта привела к его полному изменению.
В запросы добавлены переменные для минимизации ручных корректировок при измененении данных.
Для проверки ключевых моментов каждого запроса добавлены pre-request scripts и/или tests.

Ссылка на сайт, который использовался в проекте, и swagger:
https://demoqa.com/login
https://demoqa.com/swagger/#/


Проект начинается с создания нового пользователя, который проходит процесс регистрации и заходит в свой аккаунт.
Пользователь может посмотреть все книги в магазине, добавить их в свой аккаунт, удалить все книги из аккаунта или удалить аккаунт.

Проект по шагам:
* Первый запрос на создание нового пользователя - POST.
В теле запроса передаем имя пользователя и пароль (через переменные).
Чтобы каждый раз не придумывать новое имя, в pre-request scripts добавляем генерацию имени пользователя и эту переменную используем в теле запроса.
К имени пользователя только один критерий - не совпадать с уже созданным пользователем.
Так как пароль можно использовать один на все запросы, добавляем его в переменную окружения.
В tests проверяем статус код 201 (Created) и наличие имени пользователя в response.

* Второй, третий и четвертый запросы похожи, они все POST (генерация токена, авторизация, логирование), в каждом одинаковое тело запроса.
Также передаем имя пользователя и пароль через переменные, добавляем тесты на статус код 200 (OK).
В запросе на генерацию токена добавлен тест на получение строки с токеном в response.
В запросе на авторизацию добавлен тест на получение true в response.
В запросе на логирование добавлены тесты на получение строки с токеном и идентификационным номером пользователя, которые добавляем в переменные окружения.
Эти переменные будут необходимы для дальнейших запросов.

* В следующем запросе GET получаем информацию о пользователе.
Добавляем переменную с токеном для авторизации и в путь запроса переменную с userId. 
В pre-request scripts информационно выводим данные о наличии и значениях идентификационного номера пользователя и токена.
В тестах проверяем статус код 200 (OK) и отсутствие книг у пользователя в аккаунте.

* В следующем запросе GET получаем информацию о доступных в магазине книгах.
Здесь не требуется userId и токен.
В тестах устанавливаем в переменную коллекции информацию о количестве доступных книг, а также проверяем, что их количество больше 0.
Стандартно проверяем статус код 200 (OK).
Выделяем идентификаторы книг в отдельный массив, который будет использоваться в следующем запросе через переменную коллекции.

* Следующим запросом POST добавляем книги пользователю.
В исходных версиях проекта добавление книг было по индентификатору, но добавление всех книг последовательным циклом интереснее и сложнее.
В версии 1 запрос работает через Run Collection, запуск части коллекции сохранен в файл "Postman Interceptor https---demoqa.com-login.postman_test_run.json".
При единичном запуске добавление будет только одной первой книги из массива, что кладет тест на проверку добавления всех доступных книг.
В версии 2 код исправлен и позволяет запускать вручную для возможности добавления всех книг пользователю последовательно.
В этом запросе также требуется добавить переменную с токеном для авторизации.
В теле запроса используются переменные userId и текущий идентификатор книги.
В tests проверяем статус код 201 (Created).
В pre-request scripts назначается текущий идентификатор книги, который сдвигается на единицу при каждом новом цикле.
При запуске через Run collection должно работать так: повтор запуска данного запроса будет до тех пор, пока не закончится массив, когда все книги будут добавлены, идет переход на следующий запрос.
При ручном запуске, после добавления последней книги (на девятом нажатии) падает тест на проверку статуса запроса и в консоли выводится сообщение, что все книги пользователю уже добавлены.

* В следующем запросе GET получаем информацию о пользователе после добавления книг.
Добавляем переменную с токеном для авторизации и в путь запроса переменную с userId. 
В тестах проверяем статус код 200 (OK) и соответствие ожидаемого количества книг с фактически добавленными.

* В следующем запросе DELETE удаляем все книги у пользователя.
Добавляем переменную с токеном для авторизации и переменную с userId в query params. 
В тестах проверяем статус код 204 (No Content), что соответствует success.

* В следующем запросе GET получаем информацию о пользователе после удаления всех книг.
Добавляем переменную с токеном для авторизации и в путь запроса переменную с userId. 
В тестах проверяем статус код 200 (OK) и отсутствие книг у пользователя в аккаунте.

* В следующем запросе DELETE удаляем пользователя.
Добавляем переменную с токеном для авторизации и переменную с userId в путь. 
В тестах проверяем статус код 204 (No Content), это не соответствует swagger, но фактически соответствует success.

* В следующем запросе GET получаем информацию о пользователе после удаления.
Добавляем переменную с токеном для авторизации и в путь запроса переменную с userId. 
В тестах проверяем статус код 401 (Unauthorized).
